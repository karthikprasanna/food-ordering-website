{"ast":null,"code":"var _jsxFileName = \"/home/karthik_prasanna/Desktop/arathy/frontend/src/components/vendor/actiondispatch.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Button } from 'react-bootstrap';\n\nfunction ActionDispatch(props) {\n  let productID = \"\";\n  const [product, setProduct] = useState(\"\");\n  const [quantity, setQuantity] = useState(0);\n  const [allOrders, setAllOrders] = useState([]);\n  const [allUsers, setAllUsers] = useState([]);\n  useEffect(() => {\n    productID = localStorage.getItem(\"DASS_ITEMID\");\n    console.log(\"PID:\", productID);\n    axios.get('http://localhost:4000/product/' + productID).then(response => {\n      console.log(response.data);\n      setProduct(response.data);\n      axios.get('http://localhost:4000/order/product/' + productID).then(response => {\n        console.log(response.data);\n        setAllOrders(response.data);\n      });\n    }); // also get the list of all the users\n\n    axios.get('http://localhost:4000/user/getnames/').then(response => {\n      setAllUsers(response.data);\n    });\n  }, []);\n\n  function getname(name) {\n    if (name == \"\") {\n      return \"\";\n    }\n\n    var results = allUsers.filter(function (i) {\n      return i._id == name;\n    });\n\n    if (results[0] == undefined) {\n      return \"\";\n    }\n\n    return results[0].username;\n  }\n\n  function takeAction(e) {\n    e.preventDefault();\n    productID = localStorage.getItem(\"DASS_ITEMID\");\n    const orderDetails = {\n      product: productID,\n      quantity: quantity,\n      vendor: product.vendor,\n      customer: a,\n      status: \"Waiting\"\n    };\n    const order_decrement = {\n      order_value: quantity\n    };\n    var a = 0;\n    console.log(\"sending\", orderDetails);\n    axios.post('http://localhost:4000/order/add', orderDetails).then(res => {\n      console.log(\"Ordered successfully \");\n      document.getElementById(\"comments\").innerHTML = \"Ordered successfully \";\n      axios.put('http://localhost:4000/product/order_decrement/' + productID, order_decrement).then(res => {\n        console.log(\"Decremented successfully \"); // document.getElementById(\"comments\").innerHTML=\"Ordered successfully \"\n\n        window.location.replace('/orders');\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  function rejected() {\n    if (product.status == \"COMPLETED\") {\n      document.getElementById(\"comments\").innerHTML = \"Already completed\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else {\n      productID = localStorage.getItem(\"DASS_ITEMID\");\n      const new_status = {\n        status: \"REJECTED\"\n      };\n      axios.put('http://localhost:4000/product/change_status/' + productID, new_status).then(res => {\n        document.getElementById(\"comments\").innerHTML = \"REJECTED successfully\";\n        document.getElementById(\"comments\").className = \"alert alert-success alert-dismissible fade show\";\n        product.status = \"REJECTED\";\n        axios.put('http://localhost:4000/product/reset_quantity/' + productID).then(res => {\n          window.location.replace('/products');\n        }).catch(function (error) {\n          console.log(error);\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }\n\n  function dispatch() {\n    productID = localStorage.getItem(\"DASS_ITEMID\");\n\n    if (product.status == \"Waiting\") {\n      document.getElementById(\"comments\").innerHTML = \"Order not yet placed as more items need to be ordered\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else if (product.status == \"REJECTED\") {\n      document.getElementById(\"comments\").innerHTML = \"REJECTED Order\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else if (product.status == \"Dispatched\") {\n      document.getElementById(\"comments\").innerHTML = \"Already dispatched\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else {\n      const new_status = {\n        status: \"Dispatched\"\n      };\n      axios.put('http://localhost:4000/product/change_status/' + productID, new_status).then(res => {\n        document.getElementById(\"comments\").innerHTML = \"Dispatched successfully\";\n        document.getElementById(\"comments\").className = \"alert alert-success alert-dismissible fade show\";\n        product.status = \"Dispatched\";\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }\n\n  const OrderTable = orders => {\n    console.log(\"ORDERS\", orders);\n    console.log(\"Orders\", {\n      orders\n    }.orders.orders);\n\n    if (orders == [] || orders == undefined || orders.orders[0] == undefined) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, \"No orders have been made\");\n    } else if (product.status == \"REJECTED\") {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"No-one shall order a cancelled product\");\n    } else {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(\"table\", {\n        className: \"table table-hover thead-light table-responsive-lg \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, \"Customer\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, \"Quantity\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, \"Rating\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, \"Review\"))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, {\n        orders\n      }.orders.orders.map((currentOrder, i) => {\n        return React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        }, (() => getname(currentOrder.vendor))()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, currentOrder.quantity), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, currentOrder.rating), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177\n          },\n          __self: this\n        }, currentOrder.review));\n      }))), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"danger\",\n        onClick: cancel,\n        value: cancel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"CANCEL\"), React.createElement(Button, {\n        variant: \"success\",\n        onClick: dispatch,\n        value: dispatch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, \"DISPATCH\"), React.createElement(\"div\", {\n        id: \"comments\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      })));\n    }\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, \"PRODUCT DETAILS\"), React.createElement(\"table\", {\n    className: \"table table-striped\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, \"Name\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, \" \", product.name, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210\n    },\n    __self: this\n  }, \"Price\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, \" \", product.price, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, \"Total Quantity for Dispatch\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, \" \", product.total_quantity, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, \"Quantity remaining for Dispatch\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, \" \", product.quantity_remaining, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, \"Description\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, \" \", product.description, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  }, \"Status\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, \" \", product.status, \" \")))), React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, \"ORDERS\"), React.createElement(OrderTable, {\n    orders: allOrders,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }));\n}\n\nexport default ActionDispatch;","map":{"version":3,"sources":["/home/karthik_prasanna/Desktop/arathy/frontend/src/components/vendor/actiondispatch.js"],"names":["React","useState","useEffect","axios","Button","ActionDispatch","props","productID","product","setProduct","quantity","setQuantity","allOrders","setAllOrders","allUsers","setAllUsers","localStorage","getItem","console","log","get","then","response","data","getname","name","results","filter","i","_id","undefined","username","takeAction","e","preventDefault","orderDetails","vendor","customer","a","status","order_decrement","order_value","post","res","document","getElementById","innerHTML","put","window","location","replace","catch","error","rejected","className","new_status","dispatch","OrderTable","orders","map","currentOrder","rating","review","cancel","price","total_quantity","quantity_remaining","description"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Button } from 'react-bootstrap';\n\nfunction ActionDispatch(props) {\n    let productID = \"\"\n    const [product, setProduct] = useState(\"\")\n    const [quantity, setQuantity] = useState(0)\n    const [allOrders, setAllOrders] = useState([])\n    const [allUsers, setAllUsers] = useState([])\n\n    useEffect(() => {\n        productID = localStorage.getItem(\"DASS_ITEMID\")\n        console.log(\"PID:\", productID)\n        axios.get('http://localhost:4000/product/' + productID)\n            .then(response => {\n                console.log(response.data)\n                setProduct(response.data);\n                axios.get('http://localhost:4000/order/product/' + productID)\n                    .then(response => {\n                        console.log(response.data)\n                        setAllOrders(response.data);\n                    })\n            })\n        // also get the list of all the users\n        axios.get('http://localhost:4000/user/getnames/')\n            .then(response => {\n                setAllUsers(response.data)\n            })\n    }, []);\n\n    function getname(name) {\n        if (name == \"\") {\n            return \"\"\n        }\n        var results = allUsers.filter(function (i) {\n            return i._id == name\n        })\n        if (results[0] == undefined) {\n            return \"\"\n        }\n        return (results[0].username)\n    }\n\n    function takeAction(e) {\n        e.preventDefault();\n        productID = localStorage.getItem(\"DASS_ITEMID\")\n        const orderDetails = {\n            product: productID,\n            quantity: quantity,\n            vendor: product.vendor,\n            customer: a,\n            status: \"Waiting\"\n        }\n        const order_decrement = {\n            order_value: quantity\n        }\n        var a = 0\n        console.log(\"sending\", orderDetails)\n        axios.post('http://localhost:4000/order/add', orderDetails)\n            .then(\n                res => {\n                    console.log(\"Ordered successfully \")\n                    document.getElementById(\"comments\").innerHTML = \"Ordered successfully \"\n                    axios.put('http://localhost:4000/product/order_decrement/' + productID, order_decrement).then(\n\n                        res => {\n                            console.log(\"Decremented successfully \")\n                            // document.getElementById(\"comments\").innerHTML=\"Ordered successfully \"\n                            window.location.replace('/orders')\n                        })\n                        .catch(function (error) {\n                            console.log(error);\n                        });\n\n                })\n            .catch(function (error) {\n                console.log(error);\n            });\n    }\n\n    function rejected() {\n        if (product.status == \"COMPLETED\") {\n            document.getElementById(\"comments\").innerHTML = \"Already completed\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else {\n            productID = localStorage.getItem(\"DASS_ITEMID\")\n            const new_status = {\n                status: \"REJECTED\"\n            }\n            axios.put('http://localhost:4000/product/change_status/' + productID, new_status).then(\n                res => {\n                    document.getElementById(\"comments\").innerHTML = \"REJECTED successfully\"\n                    document.getElementById(\"comments\").className = \"alert alert-success alert-dismissible fade show\"\n                    product.status = \"REJECTED\"\n                    axios.put('http://localhost:4000/product/reset_quantity/' + productID).then(\n                        res => {\n                            window.location.replace('/products')\n                        })\n                        .catch(function (error) {\n                            console.log(error);\n                        });\n                })\n                .catch(function (error) {\n                    console.log(error);\n                });\n        }\n    }\n\n    function dispatch() {\n        productID = localStorage.getItem(\"DASS_ITEMID\")\n        if (product.status == \"Waiting\") {\n            document.getElementById(\"comments\").innerHTML = \"Order not yet placed as more items need to be ordered\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else if (product.status == \"REJECTED\") {\n            document.getElementById(\"comments\").innerHTML = \"REJECTED Order\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else if (product.status == \"Dispatched\") {\n            document.getElementById(\"comments\").innerHTML = \"Already dispatched\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else {\n            const new_status = {\n                status: \"Dispatched\"\n            }\n            axios.put('http://localhost:4000/product/change_status/' + productID, new_status).then(\n                res => {\n                    document.getElementById(\"comments\").innerHTML = \"Dispatched successfully\"\n                    document.getElementById(\"comments\").className = \"alert alert-success alert-dismissible fade show\"\n                    product.status = \"Dispatched\"\n                })\n                .catch(function (error) {\n                    console.log(error);\n                });\n        }\n    }\n\n    const OrderTable = (orders) => {\n        console.log(\"ORDERS\", orders)\n        console.log(\"Orders\", { orders }.orders.orders)\n        if (orders == [] || orders == undefined || orders.orders[0] == undefined) {\n            return (\n                <div>\n                    No orders have been made\n                </div>)\n        }\n        else if (product.status == \"REJECTED\") {\n            return (\n                <div>\n                    No-one shall order a cancelled product\n                </div>\n            )\n        }\n        else {\n            return (\n                <div>\n                    <table className=\"table table-hover thead-light table-responsive-lg \">\n                        <thead>\n                            <tr>\n                                <th>Customer</th>\n                                <th>Quantity</th>\n                                <th>Rating</th>\n                                <th>Review</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {\n                                { orders }.orders.orders.map((currentOrder, i) => {\n                                    return (\n                                        <tr>\n                                            <td>{(() => getname(currentOrder.vendor))()}</td>\n                                            <td>{currentOrder.quantity}</td>\n                                            <td>{currentOrder.rating}</td>\n                                            <td>{currentOrder.review}</td>\n                                        </tr>\n                                    )\n                                })\n                            }\n                        </tbody>\n                    </table>\n\n                    <div>\n                        <Button variant=\"danger\" onClick={cancel} value={cancel}>CANCEL</Button>\n\n                        {/* if status is placed then */}\n                        <Button variant=\"success\" onClick={dispatch} value={dispatch}>DISPATCH</Button>\n\n                        <div id=\"comments\">\n                        </div>\n                    </div>\n\n                </div>\n            )\n        }\n    }\n\n    return (\n        <div>\n            <h1>PRODUCT DETAILS</h1>\n            <table className=\"table table-striped\">\n                <tbody>\n                    <tr>\n                        <th>Name</th>\n                        <td> {product.name} </td>\n                    </tr>\n                    <tr>\n                        <th>Price</th>\n                        <td> {product.price} </td>\n                    </tr>\n                    <tr>\n                        <th>Total Quantity for Dispatch</th>\n                        <td> {product.total_quantity} </td>\n                    </tr>\n                    <tr>\n                        <th>Quantity remaining for Dispatch</th>\n                        <td> {product.quantity_remaining} </td>\n                    </tr>\n                    <tr>\n                        <th>Description</th>\n                        <td> {product.description} </td>\n                    </tr>\n                    <tr>\n                        <th>Status</th>\n                        <td> {product.status} </td>\n                    </tr>\n                </tbody>\n            </table>\n\n            <h1>ORDERS</h1>\n            <OrderTable orders={allOrders} />\n        </div>\n    )\n}\nexport default ActionDispatch;"]},"metadata":{},"sourceType":"module"}
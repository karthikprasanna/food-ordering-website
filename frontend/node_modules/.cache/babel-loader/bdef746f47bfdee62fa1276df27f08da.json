{"ast":null,"code":"var _jsxFileName = \"/home/karthik_prasanna/Desktop/arathy/frontend/src/components/customer/makeorder.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction MakeOrder(props) {\n  let productID = \"\";\n  const [product, setProduct] = useState(\"\");\n  const [quantity, setQuantity] = useState(0);\n  const [allUsers, setAllUsers] = useState([]);\n  const [allRatings, setAllRatings] = useState([]);\n  useEffect(() => {\n    productID = localStorage.getItem(\"DASS_ITEMID\");\n    console.log(\"PID:\", productID);\n    axios.get('http://localhost:4000/product/' + productID).then(response => {\n      setProduct(response.data);\n      console.log(response.data);\n      console.log(response.data.images);\n\n      if (response.data.images != \"\" || response.data.images != [] || response.data.images != undefined) {\n        document.getElementById(\"images\").innerHTML = \"<br /><h1>IMAGES</h1><img src=\" + response.data.images + \" class=\\\"img-fluid.max-width: 100% height: auto rounded mx-auto d-block\\\"  >\";\n      }\n    });\n    axios.get('http://localhost:4000/user/getnames/').then(response => {\n      setAllUsers(response.data);\n    });\n    axios.get('http://localhost:4000/avg_rating/').then(response => {\n      setAllRatings(response.data);\n    });\n  }, []);\n\n  function getname(name) {\n    if (name == \"\") {\n      return \"\";\n    }\n\n    var results = allUsers.filter(function (i) {\n      return i._id == name;\n    });\n\n    if (results[0] == undefined) {\n      return \"\";\n    }\n\n    return results[0].username;\n  }\n\n  function get_rating(name) {\n    if (name == \"\") {\n      return 0;\n    }\n\n    var results = allRatings.filter(function (i) {\n      return i._id == name;\n    });\n\n    if (results[0] == undefined) {\n      return 0;\n    }\n\n    console.log(results);\n    return results[0].avgRating;\n  }\n\n  function order(e) {\n    e.preventDefault();\n\n    if (product.status != \"Waiting\") {\n      document.getElementById(\"comments\").innerHTML = \"This product is not available for delivery\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else if (product.quantity_remaining < quantity) {\n      document.getElementById(\"comments\").innerHTML = \"Please choose a smaller quantity\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else if (quantity == 0) {\n      document.getElementById(\"comments\").innerHTML = \"Choose at least 1 quantity to order\";\n      document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\";\n    } else {\n      a = localStorage.getItem(\"DASS_USERID\");\n      productID = localStorage.getItem(\"DASS_ITEMID\");\n      const orderDetails = {\n        product: productID,\n        quantity: quantity,\n        vendor: product.vendor,\n        customer: a,\n        cost: product.price,\n        rating: product.rating\n      };\n      const order_decrement = {\n        order_value: quantity\n      };\n      var a = 0;\n      console.log(\"sending\", orderDetails);\n      axios.post('http://localhost:4000/order/add', orderDetails).then(res => {\n        document.getElementById(\"comments\").innerHTML = \"Ordered successfully\";\n        document.getElementById(\"comments\").className = \"alert alert-success alert-dismissible fade show\";\n        axios.put('http://localhost:4000/product/order_decrement/' + productID, order_decrement).then(res => {\n          window.location.replace('/orders');\n        }).catch(function (error) {\n          console.log(error);\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"PRODUCT DETAILS\"), React.createElement(\"table\", {\n    className: \"table table-hover table-responsive-lg \",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, \"Name\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, \" \", product.name, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Price\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, \" \", product.price, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, \"Vendor\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, (() => getname(product.vendor))())), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, \"Quantity remaining:\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, \" \", product.quantity_remaining, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, \"Description\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \" \", product.description, \" \")), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, \"Rating\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, \" \", product.rating)), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, \"Veg/Non-veg\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, product.veggie)), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, \"Adds On\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, product.addon))))), React.createElement(\"div\", {\n    id: \"images\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, \"ORDER NOW\"), React.createElement(\"form\", {\n    onSubmit: e => order(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, \"Quantity to order: \"), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: quantity,\n    onChange: e => setQuantity(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"submit\",\n    value: \"ORDER NOW\",\n    className: \"btn btn-primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    id: \"comments\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }))));\n}\n\nexport default MakeOrder;","map":{"version":3,"sources":["/home/karthik_prasanna/Desktop/arathy/frontend/src/components/customer/makeorder.js"],"names":["React","useState","useEffect","axios","MakeOrder","props","productID","product","setProduct","quantity","setQuantity","allUsers","setAllUsers","allRatings","setAllRatings","localStorage","getItem","console","log","get","then","response","data","images","undefined","document","getElementById","innerHTML","getname","name","results","filter","i","_id","username","get_rating","avgRating","order","e","preventDefault","status","className","quantity_remaining","a","orderDetails","vendor","customer","cost","price","rating","order_decrement","order_value","post","res","put","window","location","replace","catch","error","description","veggie","addon","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction MakeOrder(props) {\n\n    let productID = \"\"\n    const [product, setProduct] = useState(\"\")\n    const [quantity, setQuantity] = useState(0)\n    const [allUsers, setAllUsers] = useState([])\n    const [allRatings, setAllRatings] = useState([])\n    \n\n    useEffect(() => {\n        productID = localStorage.getItem(\"DASS_ITEMID\")\n        console.log(\"PID:\", productID)\n        axios.get('http://localhost:4000/product/' + productID)\n            .then(response => {\n                setProduct(response.data)\n                console.log(response.data)\n                console.log(response.data.images)\n\n                if (response.data.images != \"\" || response.data.images != [] || response.data.images != undefined) {\n                    document.getElementById(\"images\").innerHTML = \"<br /><h1>IMAGES</h1><img src=\" + response.data.images + \" class=\\\"img-fluid.max-width: 100% height: auto rounded mx-auto d-block\\\"  >\"\n                }\n            })\n        axios.get('http://localhost:4000/user/getnames/')\n            .then(response => {\n                setAllUsers(response.data)\n            })\n        axios.get('http://localhost:4000/avg_rating/')\n            .then(response => {\n                setAllRatings(response.data)\n            })\n    }, []);\n\n    function getname(name) {\n        if (name == \"\") {\n            return \"\"\n        }\n        var results = allUsers.filter(function (i) {\n            return i._id == name\n        })\n        if (results[0] == undefined) {\n            return \"\"\n        }\n        return (results[0].username)\n    }\n\n    function get_rating(name) {\n        if (name == \"\") {\n            return 0\n        }\n        var results = allRatings.filter(function (i) {\n            return i._id == name\n        })\n        if (results[0] == undefined) {\n            return 0\n        }\n        console.log(results)\n        return (results[0].avgRating)\n    }\n\n    function order(e) {\n        e.preventDefault();\n        if (product.status != \"Waiting\") {\n            document.getElementById(\"comments\").innerHTML = \"This product is not available for delivery\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else if (product.quantity_remaining < quantity) {\n            document.getElementById(\"comments\").innerHTML = \"Please choose a smaller quantity\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else if (quantity == 0) {\n            document.getElementById(\"comments\").innerHTML = \"Choose at least 1 quantity to order\"\n            document.getElementById(\"comments\").className = \"alert alert-danger alert-dismissible fade show\"\n        }\n        else {\n            a = localStorage.getItem(\"DASS_USERID\")\n            productID = localStorage.getItem(\"DASS_ITEMID\")\n            const orderDetails = {\n                product: productID,\n                quantity: quantity,\n                vendor: product.vendor,\n                customer: a,\n                cost: product.price,\n                rating: product.rating,\n                \n            }\n            const order_decrement = {\n                order_value: quantity\n            }\n            var a = 0\n            console.log(\"sending\", orderDetails)\n            axios.post('http://localhost:4000/order/add', orderDetails)\n                .then(res => {\n                    document.getElementById(\"comments\").innerHTML = \"Ordered successfully\"\n                    document.getElementById(\"comments\").className = \"alert alert-success alert-dismissible fade show\"\n                    axios.put('http://localhost:4000/product/order_decrement/' + productID, order_decrement)\n                        .then(res => {\n                            window.location.replace('/orders')\n                        })\n                        .catch(function (error) {\n                            console.log(error);\n                        });\n                })\n                .catch(function (error) {\n                    console.log(error);\n                });\n        }\n    }\n\n    return (\n        <div>\n            <div>\n                <h1>PRODUCT DETAILS</h1>\n                <table className=\"table table-hover table-responsive-lg \">\n                    <tbody>\n                        <tr>\n                            <th>Name</th>\n                            <td> {product.name} </td>\n                        </tr>\n                        <tr>\n                            <th>Price</th>\n                            <td> {product.price} </td>\n                        </tr>\n                        <tr>\n                            <th>Vendor</th>\n                            <td>{(() => getname(product.vendor))()}</td>\n                        </tr>\n                        <tr>\n                            <th>Quantity remaining:</th>\n                            <td> {product.quantity_remaining} </td>\n                        </tr>\n                        <tr>\n                            <th>Description</th>\n                            <td> {product.description} </td>\n                        </tr>\n                        <tr>\n                            <th>Rating</th>\n                            <td> {product.rating}</td>\n                        </tr>\n                        <tr>\n                            <th>Veg/Non-veg</th>\n                            <td>{product.veggie}</td>\n                        </tr>\n                        <tr>\n                            <th>Adds On</th>\n                            <td>{product.addon}</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n            <div id=\"images\"> \n            </div>\n            <br />\n\n            <div>\n                <h1>ORDER NOW</h1>\n                <form onSubmit={e => order(e)} >\n                    <div className=\"form-group\">\n                        <label>Quantity to order: </label>\n                        <input type=\"text\"\n                            className=\"form-control\"\n                            value={quantity}\n                            onChange={e => setQuantity(e.target.value)}\n                        />\n                    </div>\n                    <div className=\"form-group\">\n                        <input type=\"submit\" value=\"ORDER NOW\" className=\"btn btn-primary\" />\n                    </div>\n                    <div id=\"comments\">\n                    </div>\n                </form>\n            </div>\n        </div>\n    )\n}\nexport default MakeOrder;"]},"metadata":{},"sourceType":"module"}
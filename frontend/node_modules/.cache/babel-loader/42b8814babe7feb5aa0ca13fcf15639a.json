{"ast":null,"code":"var _jsxFileName = \"/home/karthik_prasanna/Desktop/arathy/frontend/src/components/vendor/foodmenu.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Fuse from 'fuse.js';\nimport { Button } from 'react-bootstrap';\n\nfunction Home(props) {\n  let productID = \"\";\n  const [ID, setID] = useState(\"0\");\n  const [product, setProduct] = useState([]);\n  const [allProducts, setAllProducts] = useState([]);\n  const [searchString, setSearchString] = useState(\"\");\n  const [allUsers, setAllUsers] = useState([]);\n  const [sortPrice, setSortPrice] = useState(0); // 0 for no sort, 1 for ascending, 2 for descending\n\n  const [sortRating, setSortRating] = useState(0); // 0 for no sort, 1 for ascending, 2 for descending\n\n  const [allRatings, setAllRatings] = useState([]);\n  const [updateNow, setUpdateNow] = useState(0);\n  useEffect(() => {\n    axios.get('http://localhost:4000/product/showallwaiting').then(res => {\n      //   console.log(res.data)\n      setAllProducts(res.data);\n      setProduct(res.data); // also get the list of all the users\n\n      axios.get('http://localhost:4000/user/getnames/').then(response => {\n        //    console.log(\"users\", response.data)\n        setAllUsers(response.data);\n      }); // also get the list of all ratings\n\n      axios.get('http://localhost:4000/avg_rating/').then(response => {\n        setAllRatings(response.data);\n      });\n    });\n  }, []);\n\n  function getname(name) {\n    // console.log(\"NAME\", name)\n    if (name == \"\") {\n      return \"\";\n    }\n\n    var results = allUsers.filter(function (i) {\n      return i._id == name;\n    });\n\n    if (results[0] == undefined) {\n      return \"\";\n    }\n\n    return results[0].username;\n  }\n\n  function get_rating(name) {\n    if (name == \"\") {\n      return 0;\n    }\n\n    var results = allRatings.filter(function (i) {\n      return i._id == name;\n    });\n\n    if (results[0] == undefined) {\n      return 0;\n    }\n\n    console.log(results);\n    return results[0].avgRating;\n  }\n\n  function GetSortOrderPrice(order) {\n    return function (a, b) {\n      if (a[\"price\"] > b[\"price\"]) {\n        if (order == 1) //ascending\n          return 1;else return -1;\n      } else if (a[\"price\"] < b[\"price\"]) {\n        if (order == 1) //ascending\n          return -1;else return 1;\n      }\n\n      return 0;\n    };\n  }\n\n  function GetSortOrderRating(order) {\n    return function (a, b) {\n      let a_rating = get_rating(a[\"vendor\"]);\n      let b_rating = get_rating(b[\"vendor\"]);\n\n      if (a_rating > b_rating) {\n        if (order == 1) //ascending\n          return 1;else return -1;\n      } else if (a_rating < b_rating) {\n        if (order == 1) //ascending\n          return -1;else return 1;\n      }\n\n      return 0;\n    };\n  }\n\n  function updateList(e) {\n    e.preventDefault();\n    var options = {\n      shouldSort: true,\n      threshold: 0.6,\n      location: 0,\n      distance: 100,\n      maxPatternLength: 32,\n      minMatchCharLength: 1,\n      keys: [\"name\"]\n    };\n    var fuse = new Fuse(allProducts, options); // \"list\" is the item array\n\n    var results = fuse.search(searchString); //   console.log(searchString, sortPrice, sortRating)\n\n    /*  var results = allProducts.filter(function (i) {\n         return i.name.indexOf(searchString) !== -1;\n     }) */\n    //  console.log(results)\n\n    if (searchString == \"\") {\n      results = allProducts;\n    } // for the sort in ascending and descending\n\n\n    results.sort(GetSortOrderPrice(sortPrice)); //1 for ascending 2 for descending\n\n    results.sort(GetSortOrderRating(sortRating));\n    setProduct(results);\n    setUpdateNow(2); // console.log(product)\n  }\n\n  function makeOrder(e) {\n    productID = e;\n    localStorage.setItem(\"DASS_ITEMID\", productID); //   console.log(productID)\n\n    window.location.replace(\"/makeorder\");\n  }\n\n  function helper() {\n    setUpdateNow(10);\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    onSubmit: e => updateList(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, \"Search Product: \"), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    value: searchString,\n    onChange: e => setSearchString(e.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, \"Sort by Price:   \"), React.createElement(\"input\", {\n    type: \"radio\"\n    /* className=\"form-control\" */\n    ,\n    value: \"PriceAscending\",\n    name: \"Price\",\n    onChange: e => setSortPrice(1),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }), \"Ascending\", React.createElement(\"input\", {\n    type: \"radio\"\n    /* className=\"form-control\" */\n    ,\n    name: \"Price\",\n    value: \"PriceDescending\",\n    onChange: e => setSortPrice(2),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }), \"Descending\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"Sort by Rating:   \"), React.createElement(\"input\", {\n    type: \"radio\"\n    /* className=\"form-control\" */\n    ,\n    value: \"RatingAscending\",\n    name: \"Rating\",\n    onChange: e => setSortRating(1),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }), \"Ascending\", React.createElement(\"input\", {\n    type: \"radio\"\n    /* className=\"form-control\" */\n    ,\n    value: \"RatingDescending\",\n    name: \"Rating\",\n    onChange: e => setSortRating(2),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }), \"Descending\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"submit\",\n    value: \"SEARCH\",\n    className: \"btn btn-primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    type: \"button\",\n    onClick: helper,\n    className: \"btn btn-warning\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, \" Update values \")))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, React.createElement(\"table\", {\n    className: \"table table-hover thead-light table-responsive-lg \",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(\"thead\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, \"Name\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, \"Price\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, \"Vendor\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, \"Quantity remaining:\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, \"Description\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, \"Rating\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, \"Veg/Non-veg\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }, \"Adds On\"), React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210\n    },\n    __self: this\n  }, \"Order Now!\"))), React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  }, {\n    product\n  }.product.map((currentProduct, i) => {\n    return React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, currentProduct.name), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, currentProduct.price), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, (() => getname(currentProduct.vendor))()), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, currentProduct.quantity_remaining), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, currentProduct.description), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, currentProduct.rating), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, currentProduct.veggie), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, currentProduct.addon), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"primary\",\n      onClick: () => makeOrder(currentProduct._id),\n      value: currentProduct._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, \"Order\")));\n  })))));\n}\n\nexport default Home;","map":{"version":3,"sources":["/home/karthik_prasanna/Desktop/arathy/frontend/src/components/vendor/foodmenu.js"],"names":["React","useState","useEffect","axios","Fuse","Button","Home","props","productID","ID","setID","product","setProduct","allProducts","setAllProducts","searchString","setSearchString","allUsers","setAllUsers","sortPrice","setSortPrice","sortRating","setSortRating","allRatings","setAllRatings","updateNow","setUpdateNow","get","then","res","data","response","getname","name","results","filter","i","_id","undefined","username","get_rating","console","log","avgRating","GetSortOrderPrice","order","a","b","GetSortOrderRating","a_rating","b_rating","updateList","e","preventDefault","options","shouldSort","threshold","location","distance","maxPatternLength","minMatchCharLength","keys","fuse","search","sort","makeOrder","localStorage","setItem","window","replace","helper","target","value","map","currentProduct","price","vendor","quantity_remaining","description","rating","veggie","addon"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Fuse from 'fuse.js'\nimport { Button } from 'react-bootstrap';\n\nfunction Home(props) {\n    let productID = \"\"\n    const [ID, setID] = useState(\"0\");\n    const [product, setProduct] = useState([])\n    const [allProducts, setAllProducts] = useState([])\n    const [searchString, setSearchString] = useState(\"\")\n    const [allUsers, setAllUsers] = useState([])\n    const [sortPrice, setSortPrice] = useState(0) // 0 for no sort, 1 for ascending, 2 for descending\n    const [sortRating, setSortRating] = useState(0)// 0 for no sort, 1 for ascending, 2 for descending\n    const [allRatings, setAllRatings] = useState([])\n    const [updateNow, setUpdateNow] = useState(0)\n\n    useEffect(() => {\n        axios.get('http://localhost:4000/product/showallwaiting')\n            .then(res => {\n                //   console.log(res.data)\n                setAllProducts(res.data)\n                setProduct(res.data)\n                // also get the list of all the users\n                axios.get('http://localhost:4000/user/getnames/')\n                    .then(response => {\n                        //    console.log(\"users\", response.data)\n                        setAllUsers(response.data)\n                    })\n                // also get the list of all ratings\n                axios.get('http://localhost:4000/avg_rating/')\n                    .then(response => {\n                        setAllRatings(response.data)\n                    })\n            })\n    }, []);\n\n    function getname(name) {\n        // console.log(\"NAME\", name)\n        if (name == \"\") {\n            return \"\"\n        }\n        var results = allUsers.filter(function (i) {\n            return i._id == name\n        })\n        if (results[0] == undefined) {\n            return \"\"\n        }\n        return (results[0].username)\n    }\n\n    function get_rating(name) {\n        if (name == \"\") {\n            return 0\n        }\n        var results = allRatings.filter(function (i) {\n            return i._id == name\n        })\n        if (results[0] == undefined) {\n            return 0\n        }\n        console.log(results)\n        return (results[0].avgRating)\n    }\n\n    function GetSortOrderPrice(order) {\n        return function (a, b) {\n            if (a[\"price\"] > b[\"price\"]) {\n                if (order == 1)//ascending\n                    return 1;\n                else\n                    return -1\n            }\n            else if (a[\"price\"] < b[\"price\"]) {\n                if (order == 1)//ascending\n                    return -1;\n                else\n                    return 1;\n            }\n            return 0;\n        }\n    }\n\n    function GetSortOrderRating(order) {\n        return function (a, b) {\n            let a_rating = get_rating(a[\"vendor\"])\n            let b_rating = get_rating(b[\"vendor\"])\n            if (a_rating > b_rating) {\n                if (order == 1)//ascending\n                    return 1;\n                else\n                    return -1\n            }\n            else if (a_rating < b_rating) {\n                if (order == 1)//ascending\n                    return -1;\n                else\n                    return 1;\n            }\n            return 0;\n        }\n    }\n\n    function updateList(e) {\n        e.preventDefault();\n        var options = {\n            shouldSort: true,\n            threshold: 0.6,\n            location: 0,\n            distance: 100,\n            maxPatternLength: 32,\n            minMatchCharLength: 1,\n            keys: [\n                \"name\"\n            ]\n        };\n        var fuse = new Fuse(allProducts, options); // \"list\" is the item array\n        var results = fuse.search(searchString);\n\n        //   console.log(searchString, sortPrice, sortRating)\n        /*  var results = allProducts.filter(function (i) {\n             return i.name.indexOf(searchString) !== -1;\n         }) */\n        //  console.log(results)\n        if (searchString == \"\") {\n            results = allProducts\n        }\n        // for the sort in ascending and descending\n        results.sort(GetSortOrderPrice(sortPrice))//1 for ascending 2 for descending\n        results.sort(GetSortOrderRating(sortRating))\n        setProduct(results)\n        setUpdateNow(2)\n        // console.log(product)\n    }\n\n    function makeOrder(e) {\n        productID = e\n        localStorage.setItem(\"DASS_ITEMID\", productID)\n        //   console.log(productID)\n        window.location.replace(\"/makeorder\")\n    }\n\n    function helper() {\n        setUpdateNow(10)\n    }\n\n    return (\n        <div>\n            <div>\n                <form onSubmit={e => updateList(e)} >\n                    <div className=\"form-group\">\n                        <label>Search Product: </label>\n                        <input type=\"text\"\n                            className=\"form-control\"\n                            value={searchString}\n                            onChange={e => setSearchString(e.target.value)}\n                        />\n                    </div>\n                    <div className=\"form-group\">\n                        <label>Sort by Price:   </label>\n                        <input type=\"radio\"\n                            /* className=\"form-control\" */\n                            value=\"PriceAscending\"\n                            name=\"Price\"\n                            onChange={e => setSortPrice(1)}\n                        />Ascending\n                        <input type=\"radio\"\n                            /* className=\"form-control\" */\n                            name=\"Price\"\n                            value=\"PriceDescending\"\n                            onChange={e => setSortPrice(2)}\n                        />Descending\n                    </div>\n                    <div className=\"form-group\">\n                        <label>Sort by Rating:   </label>\n                        <input type=\"radio\"\n                            /* className=\"form-control\" */\n                            value=\"RatingAscending\"\n                            name=\"Rating\"\n                            onChange={e => setSortRating(1)}\n                        />Ascending\n                        <input type=\"radio\"\n                            /* className=\"form-control\" */\n                            value=\"RatingDescending\"\n                            name=\"Rating\"\n                            onChange={e => setSortRating(2)}\n                        />Descending\n                    </div>\n\n                    <div className=\"form-group\">\n                        <input type=\"submit\" value=\"SEARCH\" className=\"btn btn-primary\" />\n                        <button type=\"button\" onClick={helper} className=\"btn btn-warning\"> Update values </button>\n                    </div>\n\n                </form>\n            </div>\n\n            <div>\n                <table className=\"table table-hover thead-light table-responsive-lg \">\n                    <thead>\n                        <tr>\n                            <th>Name</th>\n                            <th>Price</th>\n                            <th>Vendor</th>\n                            <th>Quantity remaining:</th>\n                            <th>Description</th>\n                            <th>Rating</th>\n                            <th>Veg/Non-veg</th>\n                            <th>Adds On</th>\n                            <th>Order Now!</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {\n                            { product }.product.map((currentProduct, i) => {\n                                return (\n                                    <tr>\n                                        <td>{currentProduct.name}</td>\n                                        <td>{currentProduct.price}</td>\n                                        <td>{(() => getname(currentProduct.vendor))()}</td>\n                                        <td>{currentProduct.quantity_remaining}</td>\n                                        <td>{currentProduct.description}</td>\n                                        <td>{currentProduct.rating}</td>\n                                        <td>{currentProduct.veggie}</td>\n                                        <td>{currentProduct.addon}</td>\n                                        <td><Button variant=\"primary\" onClick={() => makeOrder(currentProduct._id)} value={currentProduct._id}>Order</Button></td>\n                                    </tr>\n                                )\n                            })\n                        }\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    )\n\n}\n\nexport default Home;"]},"metadata":{},"sourceType":"module"}